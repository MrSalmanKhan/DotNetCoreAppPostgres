@using System.Text.Json
@{
    ViewData["Title"] = "Chat";
    var currentUserNameJson = JsonSerializer.Serialize(User?.Identity?.Name ?? "Anonymous");
    var currentUserPictureJson = JsonSerializer.Serialize(
        User?.Claims?.FirstOrDefault(c => c.Type == "picture")?.Value
        ?? Url.Content("~/images/default-avatar.png")
    );
}

<h1>💬 Real-Time Chat</h1>

<div class="chat-container">
    <!-- Users Sidebar -->
    <div class="chat-users">
        <h3>Users</h3>
        <ul id="usersList" class="list-unstyled m-0 p-0"></ul>
    </div>

    <!-- Chat Area -->
    <div class="chat-area flex-grow-1 d-flex flex-column">
        <div id="messagesList" class="chat-messages flex-grow-1"></div>

        <div class="input-group mt-3">
            <input type="text" id="messageInput" class="form-control" placeholder="Type a message..." />
            <button id="sendButton" class="btn btn-primary" disabled>Send</button>
        </div>
    </div>
</div>

<!-- Pass current user info to JS -->
<script>
    window.currentUser = @Html.Raw(currentUserNameJson);
    window.currentUserPicture = @Html.Raw(currentUserPictureJson);
</script>
